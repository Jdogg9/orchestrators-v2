# Tool policy rules (optional)
# Enable with: ORCH_TOOL_POLICY_ENFORCE=1
# Paths can be overridden via ORCH_TOOL_POLICY_PATH

rules:
  - match: "^echo$"
    action: allow
    reason: "allow_echo"
    require_safe: true

  - match: "^safe_calc$"
    action: allow
    reason: "allow_safe_calc"
    require_safe: true

  - match: "^summarize_text$"
    action: allow
    reason: "allow_summarize_text"
    require_safe: true

  - match: "^web_search$"
    action: allow
    reason: "allow_web_search"
    conditions:
      input_param: "query"
      max_input_len: 500

  # Conditional approvals (example): allow python_exec only for short inputs.
  # - match: "^python_exec$"
  #   action: allow
  #   reason: "allow_python_exec_short_input"
  #   conditions:
  #     input_param: "code"
  #     max_input_len: 500

  - match: "^python_eval$"
    action: deny
    reason: "deny_python_eval_by_default"

  - match: "^python_exec$"
    action: deny
    reason: "deny_python_exec_by_default"

  - match: ".*"
    action: deny
    reason: "default_deny"
